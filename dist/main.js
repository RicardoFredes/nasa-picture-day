document.addEventListener("DOMContentLoaded",(()=>{const e={error:!0,url:"404.jpg",media_type:"image"},t=864e5,n=document.getElementById("brand"),a=document.getElementById("next-button"),o=document.getElementById("previous-button"),s=document.getElementById("modal");let d,c=0;const i=(e=0)=>"&date="+new Date(d-t*e).toISOString().replace(/T.*/,""),r=e=>{const t=document.createElement("img");return t.src=e,t},l=e=>{const t=document.createElement("embed");return t.src=e+"?autoplay=0&mute=1&controls=1&showinfo=0&rel=0&autohide=1",t},m=()=>{s.classList.add("hide"),s.innerHTML=""},u=(e,t)=>{const n=`\n        <div class="content">\n            <a onclick="history.back()">[X] CLOSE</a>\n            <h1>${e.title}</h1>\n            <small>${e.date}</small>\n            <p>${e.explanation}</p>\n        </div>\n        <a href="${e.hdurl}" title="Open large size image" target="_blank" class="media">${t}</a>\n        `;s.innerHTML=n,s.classList.remove("hide"),h()},p=async(t=1)=>{if(!(t>7))return(async t=>{const n="https://api.nasa.gov/planetary/apod?api_key=Owy40anZTbWVb0Hbe3fYEkv6OqG2qdLYyQc9y7Th"+i(t);return fetch(n).then((t=>t.ok?t.json():e))})(t-1).then((e=>((({id:e,data:t})=>{const n=document.getElementById(e),{media_type:a,url:o,error:s}=t,d="image"===a?r(o):l(o);d.onload=()=>n.classList.remove("hide"),n.append(d),s||(n.onclick=()=>u(t,d.outerHTML))})({id:"day"+t,data:e}),p(t+1))))},y=(e=1)=>{if(e>7)return;const t=document.getElementById("day"+e);t.classList.add("hide"),t.innerHTML="",y(e+1)};o.onclick=()=>L(c+1),a.onclick=()=>L(c-1),n.onclick=()=>c&&L(0);const h=()=>{const e={page:c},t=c?"?page="+c:"?";history.pushState(e,null,t)};window.onpopstate=()=>{const e=g();e!==c?L(e,{notUpdateHistory:!0}):m()};const g=()=>{const e=location.search.replace(/.*page=(\d)/,"$1");return Number(e)||0},L=(e,n={})=>{"number"==typeof e&&(c=e),m(),y(),(()=>{const e=new Date,n=e.getTime(),a=7*c*t,o=6e4*(e.getTimezoneOffset()+3);d=n-o-a})(),p(),0===c?a.classList.add("hide"):a.classList.remove("hide"),n.notUpdateHistory||h()};L(g(),{notUpdateHistory:!0})}));
